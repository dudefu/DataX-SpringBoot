(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-911a6fec"],{"05a0":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.handleRunJob}},[t._v("\n      启动任务\n    ")]),t._v(" "),o("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"Type",clearable:""},on:{change:t.handleJobChange,clear:t.handleJobClear},model:{value:t.jobId,callback:function(e){t.jobId=e},expression:"jobId"}},t._l(t.pluginList,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.getJobList}},[t._v("\n      刷新任务\n    ")]),t._v(" "),o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-trash"},on:{click:function(e){t.templateJson={}}}},[t._v("\n      清空json\n    ")]),t._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:t.jobId,expression:"jobId"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-document"},on:{click:t.handleViewJobLog}},[t._v("\n      查看日志\n    ")])],1),t._v(" "),o("div",{staticClass:"editor-container"},[o("json-editor",{ref:"jsonEditor",model:{value:t.templateJson,callback:function(e){t.templateJson=e},expression:"templateJson"}})],1),t._v(" "),o("el-dialog",{attrs:{title:"日志查看",visible:t.logShow},on:{"update:visible":function(e){t.logShow=e}}},[o("div",{staticClass:"log-container"},[o("pre",{attrs:{loading:t.logLoading},domProps:{textContent:t._s(t.logContent)}})]),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.loadLog()}}},[t._v("\n        刷新日志\n      ")])],1)])],1)},i=[],a=(o("ac4d"),o("8a81"),o("ac6a"),o("b775"));function r(t){return Object(a["a"])({url:"/api/runJob",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/api/runJobLog",method:"post",data:t})}var l=o("d4a6"),u=o("fa7e"),c={components:{JsonEditor:u["a"]},data:function(){return{templateJson:{},listQuery:{current:1,size:200},pluginList:[1,2],jobId:void 0,jobLogQuery:{id:void 0,fromLineNum:0},logContent:void 0,logShow:!1,logLoading:!1}},created:function(){this.getJobList()},methods:{getJobList:function(){var t=this;Object(l["d"])(this.listQuery).then(function(e){console.log(e),t.jobId=void 0,t.jobLogQuery.fromLineNum=0,t.logContent=void 0;var o=e.records;t.pluginList=o})},handleRunJob:function(){var t=this,e={jobConfigId:this.jobId,jobJson:this.templateJson};void 0===this.jobId?r(e).then(function(e){t.$notify({title:"Success",message:"启动成功",type:"success",duration:2e3}),t.handleViewJobLog()}):s(e).then(function(e){t.$notify({title:"Success",message:"启动成功",type:"success",duration:2e3})})},handleViewJobLog:function(){void 0!==this.jobId&&(this.jobLogQuery.id=this.jobId,!1===this.logShow&&(this.logShow=!0),this.loadLog())},loadLog:function(){var t=this;this.logLoading=!0,Object(l["f"])(this.jobLogQuery).then(function(e){"\n"===e.logContent||(t.logContent=e.logContent),t.logLoading=!1})},handleJobChange:function(t){this.jobId=t,this.jobLogQuery.fromLineNum=0;var e=!0,o=!1,n=void 0;try{for(var i,a=this.pluginList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var r=i.value;if(r.id===this.jobId){this.templateJson=JSON.parse(r.configJson);break}}}catch(s){o=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(o)throw n}}},handleJobClear:function(){this.jobId=void 0,this.logShow=!1,this.logContent=void 0}}},d=c,f=(o("b2e3"),o("2877")),h=Object(f["a"])(d,n,i,!1,null,"200a9a14",null);e["default"]=h.exports},b2e3:function(t,e,o){"use strict";var n=o("e41c"),i=o.n(n);i.a},b8b0:function(t,e,o){"use strict";var n=o("f84c"),i=o.n(n);i.a},d4a6:function(t,e,o){"use strict";o.d(e,"d",function(){return i}),o.d(e,"c",function(){return a}),o.d(e,"e",function(){return r}),o.d(e,"a",function(){return s}),o.d(e,"b",function(){return l}),o.d(e,"f",function(){return u});var n=o("b775");function i(t){return Object(n["a"])({url:"/api/jobConfig",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/api/jobConfig/"+t,method:"get"})}function r(t){return Object(n["a"])({url:"/api/jobConfig/",method:"put",data:t})}function s(t){return Object(n["a"])({url:"/api/jobConfig/",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/api/jobConfig/",method:"delete",params:t})}function u(t){return Object(n["a"])({url:"/api/viewJobLog",method:"get",params:t})}},e41c:function(t,e,o){},f84c:function(t,e,o){},fa7e:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"json-editor"},[o("textarea",{ref:"textarea"})])},i=[],a=o("56b3"),r=o.n(a);o("0dd0"),o("a7be"),o("acdf"),o("f9d4"),o("8822"),o("d2de");o("ae67");var s={name:"JsonEditor",props:["value"],data:function(){return{jsonEditor:!1}},watch:{value:function(t){var e=this.jsonEditor.getValue();t!==e&&this.jsonEditor.setValue(JSON.stringify(this.value,null,2))}},mounted:function(){var t=this;this.jsonEditor=r.a.fromTextArea(this.$refs.textarea,{lineNumbers:!0,mode:"application/json",gutters:["CodeMirror-lint-markers"],theme:"rubyblue",lint:!0}),this.jsonEditor.setValue(JSON.stringify(this.value,null,2)),this.jsonEditor.on("change",function(e){t.$emit("changed",e.getValue()),t.$emit("input",e.getValue())})},methods:{getValue:function(){return this.jsonEditor.getValue()}}},l=s,u=(o("b8b0"),o("2877")),c=Object(u["a"])(l,n,i,!1,null,"fad11014",null);e["a"]=c.exports}}]);